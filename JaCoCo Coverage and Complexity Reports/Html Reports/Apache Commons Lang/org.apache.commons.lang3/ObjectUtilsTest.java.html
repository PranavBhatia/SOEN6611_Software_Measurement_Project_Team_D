<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>ObjectUtilsTest.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">commons_lang3$Jacoco_Report.exec</a> &gt; <a href="index.source.html" class="el_package">org.apache.commons.lang3</a> &gt; <span class="el_source">ObjectUtilsTest.java</span></div><h1>ObjectUtilsTest.java</h1><pre class="source lang-java linenums">/*
 * Licensed to the Apache Software Foundation (ASF) under one or more
 * contributor license agreements.  See the NOTICE file distributed with
 * this work for additional information regarding copyright ownership.
 * The ASF licenses this file to You under the Apache License, Version 2.0
 * (the &quot;License&quot;); you may not use this file except in compliance with
 * the License.  You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
package org.apache.commons.lang3;

import static org.junit.jupiter.api.Assertions.assertArrayEquals;
import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.junit.jupiter.api.Assertions.assertFalse;
import static org.junit.jupiter.api.Assertions.assertNotNull;
import static org.junit.jupiter.api.Assertions.assertNotSame;
import static org.junit.jupiter.api.Assertions.assertNull;
import static org.junit.jupiter.api.Assertions.assertSame;
import static org.junit.jupiter.api.Assertions.assertThrows;
import static org.junit.jupiter.api.Assertions.assertTrue;

import java.io.IOException;
import java.lang.reflect.Constructor;
import java.lang.reflect.Modifier;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Collections;
import java.util.Comparator;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.List;
import java.util.Map;
import java.util.Set;

import org.apache.commons.lang3.exception.CloneFailedException;
import org.apache.commons.lang3.mutable.MutableObject;
import org.apache.commons.lang3.text.StrBuilder;
import org.junit.jupiter.api.Test;

/**
 * Unit tests {@link org.apache.commons.lang3.ObjectUtils}.
 */
@SuppressWarnings(&quot;deprecation&quot;) // deliberate use of deprecated code
<span class="fc" id="L53">public class ObjectUtilsTest {</span>
    private static final String FOO = &quot;foo&quot;;
    private static final String BAR = &quot;bar&quot;;
<span class="fc" id="L56">    private static final String[] NON_EMPTY_ARRAY = new String[] { FOO, BAR, };</span>
<span class="fc" id="L57">    private static final List&lt;String&gt; NON_EMPTY_LIST = Arrays.asList(NON_EMPTY_ARRAY);</span>
<span class="fc" id="L58">    private static final Set&lt;String&gt; NON_EMPTY_SET = new HashSet&lt;&gt;(NON_EMPTY_LIST);</span>
<span class="fc" id="L59">    private static final Map&lt;String, String&gt; NON_EMPTY_MAP = new HashMap&lt;&gt;();</span>
    static {
<span class="fc" id="L61">        NON_EMPTY_MAP.put(FOO, BAR);</span>
<span class="fc" id="L62">    }</span>

    //-----------------------------------------------------------------------
    @Test
    public void testConstructor() {
<span class="fc" id="L67">        assertNotNull(new ObjectUtils());</span>
<span class="fc" id="L68">        final Constructor&lt;?&gt;[] cons = ObjectUtils.class.getDeclaredConstructors();</span>
<span class="fc" id="L69">        assertEquals(1, cons.length);</span>
<span class="fc" id="L70">        assertTrue(Modifier.isPublic(cons[0].getModifiers()));</span>
<span class="fc" id="L71">        assertTrue(Modifier.isPublic(ObjectUtils.class.getModifiers()));</span>
<span class="fc" id="L72">        assertFalse(Modifier.isFinal(ObjectUtils.class.getModifiers()));</span>
<span class="fc" id="L73">    }</span>

    //-----------------------------------------------------------------------
    @Test
    public void testIsEmpty() {
<span class="fc" id="L78">        assertTrue(ObjectUtils.isEmpty(null));</span>
<span class="fc" id="L79">        assertTrue(ObjectUtils.isEmpty(&quot;&quot;));</span>
<span class="fc" id="L80">        assertTrue(ObjectUtils.isEmpty(new int[] {}));</span>
<span class="fc" id="L81">        assertTrue(ObjectUtils.isEmpty(Collections.emptyList()));</span>
<span class="fc" id="L82">        assertTrue(ObjectUtils.isEmpty(Collections.emptySet()));</span>
<span class="fc" id="L83">        assertTrue(ObjectUtils.isEmpty(Collections.emptyMap()));</span>

<span class="fc" id="L85">        assertFalse(ObjectUtils.isEmpty(&quot;  &quot;));</span>
<span class="fc" id="L86">        assertFalse(ObjectUtils.isEmpty(&quot;ab&quot;));</span>
<span class="fc" id="L87">        assertFalse(ObjectUtils.isEmpty(NON_EMPTY_ARRAY));</span>
<span class="fc" id="L88">        assertFalse(ObjectUtils.isEmpty(NON_EMPTY_LIST));</span>
<span class="fc" id="L89">        assertFalse(ObjectUtils.isEmpty(NON_EMPTY_SET));</span>
<span class="fc" id="L90">        assertFalse(ObjectUtils.isEmpty(NON_EMPTY_MAP));</span>
<span class="fc" id="L91">    }</span>

    @Test
    public void testIsNotEmpty() {
<span class="fc" id="L95">        assertFalse(ObjectUtils.isNotEmpty(null));</span>
<span class="fc" id="L96">        assertFalse(ObjectUtils.isNotEmpty(&quot;&quot;));</span>
<span class="fc" id="L97">        assertFalse(ObjectUtils.isNotEmpty(new int[] {}));</span>
<span class="fc" id="L98">        assertFalse(ObjectUtils.isNotEmpty(Collections.emptyList()));</span>
<span class="fc" id="L99">        assertFalse(ObjectUtils.isNotEmpty(Collections.emptySet()));</span>
<span class="fc" id="L100">        assertFalse(ObjectUtils.isNotEmpty(Collections.emptyMap()));</span>

<span class="fc" id="L102">        assertTrue(ObjectUtils.isNotEmpty(&quot;  &quot;));</span>
<span class="fc" id="L103">        assertTrue(ObjectUtils.isNotEmpty(&quot;ab&quot;));</span>
<span class="fc" id="L104">        assertTrue(ObjectUtils.isNotEmpty(NON_EMPTY_ARRAY));</span>
<span class="fc" id="L105">        assertTrue(ObjectUtils.isNotEmpty(NON_EMPTY_LIST));</span>
<span class="fc" id="L106">        assertTrue(ObjectUtils.isNotEmpty(NON_EMPTY_SET));</span>
<span class="fc" id="L107">        assertTrue(ObjectUtils.isNotEmpty(NON_EMPTY_MAP));</span>
<span class="fc" id="L108">    }</span>

    //-----------------------------------------------------------------------
    @Test
    public void testIsNull() {
<span class="fc" id="L113">        final Object o = FOO;</span>
<span class="fc" id="L114">        final Object dflt = BAR;</span>
<span class="fc" id="L115">        assertSame(dflt, ObjectUtils.defaultIfNull(null, dflt), &quot;dflt was not returned when o was null&quot;);</span>
<span class="fc" id="L116">        assertSame(o, ObjectUtils.defaultIfNull(o, dflt), &quot;dflt was returned when o was not null&quot;);</span>
<span class="fc" id="L117">    }</span>

    @Test
    public void testFirstNonNull() {
<span class="fc" id="L121">        assertEquals(&quot;&quot;, ObjectUtils.firstNonNull(null, &quot;&quot;));</span>
<span class="fc" id="L122">        final String firstNonNullGenerics = ObjectUtils.firstNonNull(null, null, &quot;123&quot;, &quot;456&quot;);</span>
<span class="fc" id="L123">        assertEquals(&quot;123&quot;, firstNonNullGenerics);</span>
<span class="fc" id="L124">        assertEquals(&quot;123&quot;, ObjectUtils.firstNonNull(&quot;123&quot;, null, &quot;456&quot;, null));</span>
<span class="fc" id="L125">        assertSame(Boolean.TRUE, ObjectUtils.firstNonNull(Boolean.TRUE));</span>

        // Explicitly pass in an empty array of Object type to ensure compiler doesn't complain of unchecked generic array creation
<span class="fc" id="L128">        assertNull(ObjectUtils.firstNonNull());</span>

        // Cast to Object in line below ensures compiler doesn't complain of unchecked generic array creation
<span class="fc" id="L131">        assertNull(ObjectUtils.firstNonNull(null, null));</span>

<span class="fc" id="L133">        assertNull(ObjectUtils.firstNonNull((Object) null));</span>
<span class="fc" id="L134">        assertNull(ObjectUtils.firstNonNull((Object[]) null));</span>
<span class="fc" id="L135">    }</span>

    /**
     * Tests {@link ObjectUtils#anyNotNull(Object...)}.
     */
    @Test
    public void testAnyNotNull() {
<span class="fc" id="L142">        assertFalse(ObjectUtils.anyNotNull());</span>
<span class="fc" id="L143">        assertFalse(ObjectUtils.anyNotNull((Object) null));</span>
<span class="fc" id="L144">        assertFalse(ObjectUtils.anyNotNull((Object[]) null));</span>
<span class="fc" id="L145">        assertFalse(ObjectUtils.anyNotNull(null, null, null));</span>

<span class="fc" id="L147">        assertTrue(ObjectUtils.anyNotNull(FOO));</span>
<span class="fc" id="L148">        assertTrue(ObjectUtils.anyNotNull(null, FOO, null));</span>
<span class="fc" id="L149">        assertTrue(ObjectUtils.anyNotNull(null, null, null, null, FOO, BAR));</span>
<span class="fc" id="L150">    }</span>

    /**
     * Tests {@link ObjectUtils#allNotNull(Object...)}.
     */
    @Test
    public void testAllNotNull() {
<span class="fc" id="L157">        assertFalse(ObjectUtils.allNotNull((Object) null));</span>
<span class="fc" id="L158">        assertFalse(ObjectUtils.allNotNull((Object[]) null));</span>
<span class="fc" id="L159">        assertFalse(ObjectUtils.allNotNull(null, null, null));</span>
<span class="fc" id="L160">        assertFalse(ObjectUtils.allNotNull(null, FOO, BAR));</span>
<span class="fc" id="L161">        assertFalse(ObjectUtils.allNotNull(FOO, BAR, null));</span>
<span class="fc" id="L162">        assertFalse(ObjectUtils.allNotNull(FOO, BAR, null, FOO, BAR));</span>

<span class="fc" id="L164">        assertTrue(ObjectUtils.allNotNull());</span>
<span class="fc" id="L165">        assertTrue(ObjectUtils.allNotNull(FOO));</span>
<span class="fc" id="L166">        assertTrue(ObjectUtils.allNotNull(FOO, BAR, 1, Boolean.TRUE, new Object(), new Object[]{}));</span>
<span class="fc" id="L167">    }</span>

    //-----------------------------------------------------------------------
    @Test
    public void testEquals() {
<span class="fc" id="L172">        assertTrue(ObjectUtils.equals(null, null), &quot;ObjectUtils.equals(null, null) returned false&quot;);</span>
<span class="pc bpc" id="L173" title="1 of 2 branches missed.">        assertTrue(!ObjectUtils.equals(FOO, null), &quot;ObjectUtils.equals(\&quot;foo\&quot;, null) returned true&quot;);</span>
<span class="pc bpc" id="L174" title="1 of 2 branches missed.">        assertTrue(!ObjectUtils.equals(null, BAR), &quot;ObjectUtils.equals(null, \&quot;bar\&quot;) returned true&quot;);</span>
<span class="pc bpc" id="L175" title="1 of 2 branches missed.">        assertTrue(!ObjectUtils.equals(FOO, BAR), &quot;ObjectUtils.equals(\&quot;foo\&quot;, \&quot;bar\&quot;) returned true&quot;);</span>
<span class="fc" id="L176">        assertTrue(ObjectUtils.equals(FOO, FOO), &quot;ObjectUtils.equals(\&quot;foo\&quot;, \&quot;foo\&quot;) returned false&quot;);</span>
<span class="fc" id="L177">    }</span>

    @Test
    public void testNotEqual() {
<span class="fc" id="L181">        assertFalse(ObjectUtils.notEqual(null, null), &quot;ObjectUtils.notEqual(null, null) returned false&quot;);</span>
<span class="fc" id="L182">        assertTrue(ObjectUtils.notEqual(FOO, null), &quot;ObjectUtils.notEqual(\&quot;foo\&quot;, null) returned true&quot;);</span>
<span class="fc" id="L183">        assertTrue(ObjectUtils.notEqual(null, BAR), &quot;ObjectUtils.notEqual(null, \&quot;bar\&quot;) returned true&quot;);</span>
<span class="fc" id="L184">        assertTrue(ObjectUtils.notEqual(FOO, BAR), &quot;ObjectUtils.notEqual(\&quot;foo\&quot;, \&quot;bar\&quot;) returned true&quot;);</span>
<span class="fc" id="L185">        assertFalse(ObjectUtils.notEqual(FOO, FOO), &quot;ObjectUtils.notEqual(\&quot;foo\&quot;, \&quot;foo\&quot;) returned false&quot;);</span>
<span class="fc" id="L186">    }</span>

    @Test
    public void testHashCode() {
<span class="fc" id="L190">        assertEquals(0, ObjectUtils.hashCode(null));</span>
<span class="fc" id="L191">        assertEquals(&quot;a&quot;.hashCode(), ObjectUtils.hashCode(&quot;a&quot;));</span>
<span class="fc" id="L192">    }</span>

    @Test
    public void testHashCodeMulti_multiple_emptyArray() {
<span class="fc" id="L196">        final Object[] array = new Object[0];</span>
<span class="fc" id="L197">        assertEquals(1, ObjectUtils.hashCodeMulti(array));</span>
<span class="fc" id="L198">    }</span>

    @Test
    public void testHashCodeMulti_multiple_nullArray() {
<span class="fc" id="L202">        final Object[] array = null;</span>
<span class="fc" id="L203">        assertEquals(1, ObjectUtils.hashCodeMulti(array));</span>
<span class="fc" id="L204">    }</span>

    @Test
    public void testHashCodeMulti_multiple_likeList() {
<span class="fc" id="L208">        final List&lt;Object&gt; list0 = new ArrayList&lt;&gt;(Arrays.asList(new Object[0]));</span>
<span class="fc" id="L209">        assertEquals(list0.hashCode(), ObjectUtils.hashCodeMulti());</span>

<span class="fc" id="L211">        final List&lt;Object&gt; list1 = new ArrayList&lt;&gt;(Arrays.asList(&quot;a&quot;));</span>
<span class="fc" id="L212">        assertEquals(list1.hashCode(), ObjectUtils.hashCodeMulti(&quot;a&quot;));</span>

<span class="fc" id="L214">        final List&lt;Object&gt; list2 = new ArrayList&lt;&gt;(Arrays.asList(&quot;a&quot;, &quot;b&quot;));</span>
<span class="fc" id="L215">        assertEquals(list2.hashCode(), ObjectUtils.hashCodeMulti(&quot;a&quot;, &quot;b&quot;));</span>

<span class="fc" id="L217">        final List&lt;Object&gt; list3 = new ArrayList&lt;&gt;(Arrays.asList(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;));</span>
<span class="fc" id="L218">        assertEquals(list3.hashCode(), ObjectUtils.hashCodeMulti(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;));</span>
<span class="fc" id="L219">    }</span>

    @Test
    public void testIdentityToStringStringBuffer() {
<span class="fc" id="L223">        final Integer i = Integer.valueOf(45);</span>
<span class="fc" id="L224">        final String expected = &quot;java.lang.Integer@&quot; + Integer.toHexString(System.identityHashCode(i));</span>

<span class="fc" id="L226">        final StringBuffer buffer = new StringBuffer();</span>
<span class="fc" id="L227">        ObjectUtils.identityToString(buffer, i);</span>
<span class="fc" id="L228">        assertEquals(expected, buffer.toString());</span>

<span class="pc" id="L230">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString((StringBuffer) null, &quot;tmp&quot;));</span>
<span class="pc" id="L231">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString(new StringBuffer(), null));</span>
<span class="fc" id="L232">    }</span>

    @Test
    public void testIdentityToStringObjectNull() {
<span class="fc" id="L236">        assertNull(ObjectUtils.identityToString(null));</span>
<span class="fc" id="L237">    }</span>

    @Test
    public void testIdentityToStringInteger() {
<span class="fc" id="L241">        final Integer i = Integer.valueOf(90);</span>
<span class="fc" id="L242">        final String expected = &quot;java.lang.Integer@&quot; + Integer.toHexString(System.identityHashCode(i));</span>

<span class="fc" id="L244">        assertEquals(expected, ObjectUtils.identityToString(i));</span>
<span class="fc" id="L245">    }</span>

    @Test
    public void testIdentityToStringString() {
<span class="fc" id="L249">        assertEquals(</span>
<span class="fc" id="L250">                &quot;java.lang.String@&quot; + Integer.toHexString(System.identityHashCode(FOO)),</span>
<span class="fc" id="L251">                ObjectUtils.identityToString(FOO));</span>
<span class="fc" id="L252">    }</span>

    @Test
    public void testIdentityToStringStringBuilder() {
<span class="fc" id="L256">        final Integer i = Integer.valueOf(90);</span>
<span class="fc" id="L257">        final String expected = &quot;java.lang.Integer@&quot; + Integer.toHexString(System.identityHashCode(i));</span>

<span class="fc" id="L259">        final StringBuilder builder = new StringBuilder();</span>
<span class="fc" id="L260">        ObjectUtils.identityToString(builder, i);</span>
<span class="fc" id="L261">        assertEquals(expected, builder.toString());</span>
<span class="fc" id="L262">    }</span>

    @Test
    public void testIdentityToStringStringBuilderInUse() {
<span class="fc" id="L266">        final Integer i = Integer.valueOf(90);</span>
<span class="fc" id="L267">        final String expected = &quot;ABC = java.lang.Integer@&quot; + Integer.toHexString(System.identityHashCode(i));</span>

<span class="fc" id="L269">        final StringBuilder builder = new StringBuilder(&quot;ABC = &quot;);</span>
<span class="fc" id="L270">        ObjectUtils.identityToString(builder, i);</span>
<span class="fc" id="L271">        assertEquals(expected, builder.toString());</span>
<span class="fc" id="L272">    }</span>

    @Test
    public void testIdentityToStringStringBuilderNullValue() {
<span class="pc" id="L276">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString(new StringBuilder(), null));</span>
<span class="fc" id="L277">    }</span>

    @Test
    public  void testIdentityToStringStringBuilderNullStringBuilder() {
<span class="pc" id="L281">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString((StringBuilder) null, &quot;tmp&quot;));</span>
<span class="fc" id="L282">    }</span>

    @Test
    public void testIdentityToStringStrBuilder() {
<span class="fc" id="L286">        final Integer i = Integer.valueOf(102);</span>
<span class="fc" id="L287">        final String expected = &quot;java.lang.Integer@&quot; + Integer.toHexString(System.identityHashCode(i));</span>

<span class="fc" id="L289">        final StrBuilder builder = new StrBuilder();</span>
<span class="fc" id="L290">        ObjectUtils.identityToString(builder, i);</span>
<span class="fc" id="L291">        assertEquals(expected, builder.toString());</span>

<span class="pc" id="L293">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString((StrBuilder) null, &quot;tmp&quot;));</span>

<span class="pc" id="L295">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString(new StrBuilder(), null));</span>
<span class="fc" id="L296">    }</span>

    @Test
    public void testIdentityToStringAppendable() throws IOException {
<span class="fc" id="L300">        final Integer i = Integer.valueOf(121);</span>
<span class="fc" id="L301">        final String expected = &quot;java.lang.Integer@&quot; + Integer.toHexString(System.identityHashCode(i));</span>

<span class="fc" id="L303">        final Appendable appendable = new StringBuilder();</span>
<span class="fc" id="L304">        ObjectUtils.identityToString(appendable, i);</span>
<span class="fc" id="L305">        assertEquals(expected, appendable.toString());</span>

<span class="pc" id="L307">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.identityToString((Appendable) null, &quot;tmp&quot;));</span>

<span class="fc" id="L309">        assertThrows(</span>
                NullPointerException.class,
<span class="nc" id="L311">                () -&gt; ObjectUtils.identityToString((Appendable) (new StringBuilder()), null));</span>
<span class="fc" id="L312">    }</span>

    @Test
    public void testToString_Object() {
<span class="fc" id="L316">        assertEquals(&quot;&quot;, ObjectUtils.toString(null) );</span>
<span class="fc" id="L317">        assertEquals(Boolean.TRUE.toString(), ObjectUtils.toString(Boolean.TRUE) );</span>
<span class="fc" id="L318">    }</span>

    @Test
    public void testToString_ObjectString() {
<span class="fc" id="L322">        assertEquals(BAR, ObjectUtils.toString(null, BAR) );</span>
<span class="fc" id="L323">        assertEquals(Boolean.TRUE.toString(), ObjectUtils.toString(Boolean.TRUE, BAR) );</span>
<span class="fc" id="L324">    }</span>

    @SuppressWarnings(&quot;cast&quot;) // 1 OK, because we are checking for code change
    @Test
    public void testNull() {
<span class="fc" id="L329">        assertNotNull(ObjectUtils.NULL);</span>
        // 1 Check that NULL really is a Null i.e. the definition has not been changed
<span class="fc" id="L331">        assertTrue(ObjectUtils.NULL instanceof ObjectUtils.Null);</span>
<span class="fc" id="L332">        assertSame(ObjectUtils.NULL, SerializationUtils.clone(ObjectUtils.NULL));</span>
<span class="fc" id="L333">    }</span>

    @Test
    public void testMax() {
<span class="fc" id="L337">        final Calendar calendar = Calendar.getInstance();</span>
<span class="fc" id="L338">        final Date nonNullComparable1 = calendar.getTime();</span>
<span class="fc" id="L339">        final Date nonNullComparable2 = calendar.getTime();</span>
<span class="fc" id="L340">        final String[] nullArray = null;</span>

<span class="fc" id="L342">        calendar.set( Calendar.YEAR, calendar.get( Calendar.YEAR ) -1 );</span>
<span class="fc" id="L343">        final Date minComparable = calendar.getTime();</span>

<span class="fc" id="L345">        assertNotSame( nonNullComparable1, nonNullComparable2 );</span>

<span class="fc" id="L347">        assertNull(ObjectUtils.max( (String) null ) );</span>
<span class="fc" id="L348">        assertNull(ObjectUtils.max( nullArray ) );</span>
<span class="fc" id="L349">        assertSame( nonNullComparable1, ObjectUtils.max( null, nonNullComparable1 ) );</span>
<span class="fc" id="L350">        assertSame( nonNullComparable1, ObjectUtils.max( nonNullComparable1, null ) );</span>
<span class="fc" id="L351">        assertSame( nonNullComparable1, ObjectUtils.max( null, nonNullComparable1, null ) );</span>
<span class="fc" id="L352">        assertSame( nonNullComparable1, ObjectUtils.max( nonNullComparable1, nonNullComparable2 ) );</span>
<span class="fc" id="L353">        assertSame( nonNullComparable2, ObjectUtils.max( nonNullComparable2, nonNullComparable1 ) );</span>
<span class="fc" id="L354">        assertSame( nonNullComparable1, ObjectUtils.max( nonNullComparable1, minComparable ) );</span>
<span class="fc" id="L355">        assertSame( nonNullComparable1, ObjectUtils.max( minComparable, nonNullComparable1 ) );</span>
<span class="fc" id="L356">        assertSame( nonNullComparable1, ObjectUtils.max( null, minComparable, null, nonNullComparable1 ) );</span>

<span class="fc" id="L358">        assertNull( ObjectUtils.max(null, null) );</span>
<span class="fc" id="L359">    }</span>

    @Test
    public void testMin() {
<span class="fc" id="L363">        final Calendar calendar = Calendar.getInstance();</span>
<span class="fc" id="L364">        final Date nonNullComparable1 = calendar.getTime();</span>
<span class="fc" id="L365">        final Date nonNullComparable2 = calendar.getTime();</span>
<span class="fc" id="L366">        final String[] nullArray = null;</span>

<span class="fc" id="L368">        calendar.set( Calendar.YEAR, calendar.get( Calendar.YEAR ) -1 );</span>
<span class="fc" id="L369">        final Date minComparable = calendar.getTime();</span>

<span class="fc" id="L371">        assertNotSame( nonNullComparable1, nonNullComparable2 );</span>

<span class="fc" id="L373">        assertNull(ObjectUtils.min( (String) null ) );</span>
<span class="fc" id="L374">        assertNull(ObjectUtils.min( nullArray ) );</span>
<span class="fc" id="L375">        assertSame( nonNullComparable1, ObjectUtils.min( null, nonNullComparable1 ) );</span>
<span class="fc" id="L376">        assertSame( nonNullComparable1, ObjectUtils.min( nonNullComparable1, null ) );</span>
<span class="fc" id="L377">        assertSame( nonNullComparable1, ObjectUtils.min( null, nonNullComparable1, null ) );</span>
<span class="fc" id="L378">        assertSame( nonNullComparable1, ObjectUtils.min( nonNullComparable1, nonNullComparable2 ) );</span>
<span class="fc" id="L379">        assertSame( nonNullComparable2, ObjectUtils.min( nonNullComparable2, nonNullComparable1 ) );</span>
<span class="fc" id="L380">        assertSame( minComparable, ObjectUtils.min( nonNullComparable1, minComparable ) );</span>
<span class="fc" id="L381">        assertSame( minComparable, ObjectUtils.min( minComparable, nonNullComparable1 ) );</span>
<span class="fc" id="L382">        assertSame( minComparable, ObjectUtils.min( null, nonNullComparable1, null, minComparable ) );</span>

<span class="fc" id="L384">        assertNull( ObjectUtils.min(null, null) );</span>
<span class="fc" id="L385">    }</span>

    /**
     * Tests {@link ObjectUtils#compare(Comparable, Comparable, boolean)}.
     */
    @Test
    public void testCompare() {
<span class="fc" id="L392">        final Integer one = Integer.valueOf(1);</span>
<span class="fc" id="L393">        final Integer two = Integer.valueOf(2);</span>
<span class="fc" id="L394">        final Integer nullValue = null;</span>

<span class="fc" id="L396">        assertEquals(0, ObjectUtils.compare(nullValue, nullValue), &quot;Null Null false&quot;);</span>
<span class="fc" id="L397">        assertEquals(0, ObjectUtils.compare(nullValue, nullValue, true), &quot;Null Null true&quot;);</span>

<span class="fc" id="L399">        assertEquals(-1, ObjectUtils.compare(nullValue, one), &quot;Null one false&quot;);</span>
<span class="fc" id="L400">        assertEquals(1, ObjectUtils.compare(nullValue, one, true), &quot;Null one true&quot;);</span>

<span class="fc" id="L402">        assertEquals(1, ObjectUtils.compare(one, nullValue), &quot;one Null false&quot;);</span>
<span class="fc" id="L403">        assertEquals(-1, ObjectUtils.compare(one, nullValue, true), &quot;one Null true&quot;);</span>

<span class="fc" id="L405">        assertEquals(-1, ObjectUtils.compare(one, two), &quot;one two false&quot;);</span>
<span class="fc" id="L406">        assertEquals(-1, ObjectUtils.compare(one, two, true), &quot;one two true&quot;);</span>
<span class="fc" id="L407">    }</span>

    @Test
    public void testMedian() {
<span class="fc" id="L411">        assertEquals(&quot;foo&quot;, ObjectUtils.median(&quot;foo&quot;));</span>
<span class="fc" id="L412">        assertEquals(&quot;bar&quot;, ObjectUtils.median(&quot;foo&quot;, &quot;bar&quot;));</span>
<span class="fc" id="L413">        assertEquals(&quot;baz&quot;, ObjectUtils.median(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;));</span>
<span class="fc" id="L414">        assertEquals(&quot;baz&quot;, ObjectUtils.median(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;blah&quot;));</span>
<span class="fc" id="L415">        assertEquals(&quot;blah&quot;, ObjectUtils.median(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;blah&quot;, &quot;wah&quot;));</span>
<span class="fc" id="L416">        assertEquals(Integer.valueOf(5),</span>
<span class="fc" id="L417">            ObjectUtils.median(Integer.valueOf(1), Integer.valueOf(5), Integer.valueOf(10)));</span>
<span class="fc" id="L418">        assertEquals(</span>
<span class="fc" id="L419">            Integer.valueOf(7),</span>
<span class="fc" id="L420">            ObjectUtils.median(Integer.valueOf(5), Integer.valueOf(6), Integer.valueOf(7), Integer.valueOf(8),</span>
<span class="fc" id="L421">                Integer.valueOf(9)));</span>
<span class="fc" id="L422">        assertEquals(Integer.valueOf(6),</span>
<span class="fc" id="L423">            ObjectUtils.median(Integer.valueOf(5), Integer.valueOf(6), Integer.valueOf(7), Integer.valueOf(8)));</span>
<span class="fc" id="L424">    }</span>

    @Test
    public void testMedian_nullItems() {
<span class="pc" id="L428">        assertThrows(NullPointerException.class, () -&gt; ObjectUtils.median((String[]) null));</span>
<span class="fc" id="L429">    }</span>

    @Test
    public void testMedian_emptyItems() {
<span class="pc" id="L433">        assertThrows(IllegalArgumentException.class, ObjectUtils::&lt;String&gt;median);</span>
<span class="fc" id="L434">    }</span>

    @Test
    public void testComparatorMedian() {
<span class="fc" id="L438">        final CharSequenceComparator cmp = new CharSequenceComparator();</span>
<span class="fc" id="L439">        final NonComparableCharSequence foo = new NonComparableCharSequence(&quot;foo&quot;);</span>
<span class="fc" id="L440">        final NonComparableCharSequence bar = new NonComparableCharSequence(&quot;bar&quot;);</span>
<span class="fc" id="L441">        final NonComparableCharSequence baz = new NonComparableCharSequence(&quot;baz&quot;);</span>
<span class="fc" id="L442">        final NonComparableCharSequence blah = new NonComparableCharSequence(&quot;blah&quot;);</span>
<span class="fc" id="L443">        final NonComparableCharSequence wah = new NonComparableCharSequence(&quot;wah&quot;);</span>
<span class="fc" id="L444">        assertSame(foo, ObjectUtils.median(cmp, foo));</span>
<span class="fc" id="L445">        assertSame(bar, ObjectUtils.median(cmp, foo, bar));</span>
<span class="fc" id="L446">        assertSame(baz, ObjectUtils.median(cmp, foo, bar, baz));</span>
<span class="fc" id="L447">        assertSame(baz, ObjectUtils.median(cmp, foo, bar, baz, blah));</span>
<span class="fc" id="L448">        assertSame(blah, ObjectUtils.median(cmp, foo, bar, baz, blah, wah));</span>
<span class="fc" id="L449">    }</span>

    @Test
    public void testComparatorMedian_nullComparator() {
<span class="fc" id="L453">        assertThrows(NullPointerException.class,</span>
<span class="nc" id="L454">                () -&gt; ObjectUtils.median((Comparator&lt;CharSequence&gt;) null, new NonComparableCharSequence(&quot;foo&quot;)));</span>
<span class="fc" id="L455">    }</span>

    @Test
    public void testComparatorMedian_nullItems() {
<span class="fc" id="L459">        assertThrows(NullPointerException.class,</span>
<span class="nc" id="L460">                () -&gt; ObjectUtils.median(new CharSequenceComparator(), (CharSequence[]) null));</span>
<span class="fc" id="L461">    }</span>

    @Test
    public void testComparatorMedian_emptyItems() {
<span class="pc" id="L465">        assertThrows(IllegalArgumentException.class, () -&gt; ObjectUtils.median(new CharSequenceComparator()));</span>
<span class="fc" id="L466">    }</span>

    @Test
    public void testMode() {
<span class="fc" id="L470">        assertNull(ObjectUtils.mode((Object[]) null));</span>
<span class="fc" id="L471">        assertNull(ObjectUtils.mode());</span>
<span class="fc" id="L472">        assertNull(ObjectUtils.mode(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;));</span>
<span class="fc" id="L473">        assertNull(ObjectUtils.mode(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;foo&quot;, &quot;bar&quot;));</span>
<span class="fc" id="L474">        assertEquals(&quot;foo&quot;, ObjectUtils.mode(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, &quot;foo&quot;));</span>
<span class="fc" id="L475">        assertEquals(Integer.valueOf(9),</span>
<span class="fc" id="L476">            ObjectUtils.mode(&quot;foo&quot;, &quot;bar&quot;, &quot;baz&quot;, Integer.valueOf(9), Integer.valueOf(10), Integer.valueOf(9)));</span>
<span class="fc" id="L477">    }</span>

    /**
     * Tests {@link ObjectUtils#clone(Object)} with a cloneable object.
     */
    @Test
    public void testCloneOfCloneable() {
<span class="fc" id="L484">        final CloneableString string = new CloneableString(&quot;apache&quot;);</span>
<span class="fc" id="L485">        final CloneableString stringClone = ObjectUtils.clone(string);</span>
<span class="fc" id="L486">        assertEquals(&quot;apache&quot;, stringClone.getValue());</span>
<span class="fc" id="L487">    }</span>

    /**
     * Tests {@link ObjectUtils#clone(Object)} with a not cloneable object.
     */
    @Test
    public void testCloneOfNotCloneable() {
<span class="fc" id="L494">        final String string = new String(&quot;apache&quot;);</span>
<span class="fc" id="L495">        assertNull(ObjectUtils.clone(string));</span>
<span class="fc" id="L496">    }</span>

    /**
     * Tests {@link ObjectUtils#clone(Object)} with an uncloneable object.
     */
    @Test
    public void testCloneOfUncloneable() {
<span class="fc" id="L503">        final UncloneableString string = new UncloneableString(&quot;apache&quot;);</span>
<span class="pc" id="L504">        CloneFailedException e = assertThrows(CloneFailedException.class, () -&gt; ObjectUtils.clone(string));</span>
<span class="fc" id="L505">        assertEquals(NoSuchMethodException.class, e.getCause().getClass());</span>
<span class="fc" id="L506">    }</span>

    /**
     * Tests {@link ObjectUtils#clone(Object)} with an object array.
     */
    @Test
    public void testCloneOfStringArray() {
<span class="fc" id="L513">        assertTrue(Arrays.deepEquals(</span>
<span class="fc" id="L514">            new String[]{&quot;string&quot;}, ObjectUtils.clone(new String[]{&quot;string&quot;})));</span>
<span class="fc" id="L515">    }</span>

    /**
     * Tests {@link ObjectUtils#clone(Object)} with an array of primitives.
     */
    @Test
    public void testCloneOfPrimitiveArray() {
<span class="fc" id="L522">        assertArrayEquals(new int[]{1}, ObjectUtils.clone(new int[]{1}));</span>
<span class="fc" id="L523">    }</span>

    /**
     * Tests {@link ObjectUtils#cloneIfPossible(Object)} with a cloneable object.
     */
    @Test
    public void testPossibleCloneOfCloneable() {
<span class="fc" id="L530">        final CloneableString string = new CloneableString(&quot;apache&quot;);</span>
<span class="fc" id="L531">        final CloneableString stringClone = ObjectUtils.cloneIfPossible(string);</span>
<span class="fc" id="L532">        assertEquals(&quot;apache&quot;, stringClone.getValue());</span>
<span class="fc" id="L533">    }</span>

    /**
     * Tests {@link ObjectUtils#cloneIfPossible(Object)} with a not cloneable object.
     */
    @Test
    public void testPossibleCloneOfNotCloneable() {
<span class="fc" id="L540">        final String string = new String(&quot;apache&quot;);</span>
<span class="fc" id="L541">        assertSame(string, ObjectUtils.cloneIfPossible(string));</span>
<span class="fc" id="L542">    }</span>

    /**
     * Tests {@link ObjectUtils#cloneIfPossible(Object)} with an uncloneable object.
     */
    @Test
    public void testPossibleCloneOfUncloneable() {
<span class="fc" id="L549">        final UncloneableString string = new UncloneableString(&quot;apache&quot;);</span>
<span class="pc" id="L550">        CloneFailedException e = assertThrows(CloneFailedException.class, () -&gt; ObjectUtils.cloneIfPossible(string));</span>
<span class="fc" id="L551">        assertEquals(NoSuchMethodException.class, e.getCause().getClass());</span>
<span class="fc" id="L552">    }</span>

    @Test
    public void testConstMethods() {

        // To truly test the CONST() method, we'd want to look in the
        // bytecode to see if the literals were folded into the
        // class, or if the bytecode kept the method call.

<span class="fc" id="L561">        assertTrue(ObjectUtils.CONST(true), &quot;CONST(boolean)&quot;);</span>
<span class="fc" id="L562">        assertEquals((byte) 3, ObjectUtils.CONST((byte) 3), &quot;CONST(byte)&quot;);</span>
<span class="fc" id="L563">        assertEquals((char) 3, ObjectUtils.CONST((char) 3), &quot;CONST(char)&quot;);</span>
<span class="fc" id="L564">        assertEquals((short) 3, ObjectUtils.CONST((short) 3), &quot;CONST(short)&quot;);</span>
<span class="fc" id="L565">        assertEquals(3, ObjectUtils.CONST(3), &quot;CONST(int)&quot;);</span>
<span class="fc" id="L566">        assertEquals(3L, ObjectUtils.CONST(3L), &quot;CONST(long)&quot;);</span>
<span class="fc" id="L567">        assertEquals(3f, ObjectUtils.CONST(3f), &quot;CONST(float)&quot;);</span>
<span class="fc" id="L568">        assertEquals(3.0, ObjectUtils.CONST(3.0), &quot;CONST(double)&quot;);</span>
<span class="fc" id="L569">        assertEquals(&quot;abc&quot;, ObjectUtils.CONST(&quot;abc&quot;), &quot;CONST(Object)&quot;);</span>

        // Make sure documentation examples from Javadoc all work
        // (this fixed a lot of my bugs when I these!)
        //
        // My bugs should be in a software engineering textbook
        // for &quot;Can you screw this up?&quot;  The answer is, yes,
        // you can even screw this up.  (When you == Julius)
        // .
<span class="fc" id="L578">        final boolean MAGIC_FLAG = ObjectUtils.CONST(true);</span>
<span class="fc" id="L579">        final byte MAGIC_BYTE1 = ObjectUtils.CONST((byte) 127);</span>
<span class="fc" id="L580">        final byte MAGIC_BYTE2 = ObjectUtils.CONST_BYTE(127);</span>
<span class="fc" id="L581">        final char MAGIC_CHAR = ObjectUtils.CONST('a');</span>
<span class="fc" id="L582">        final short MAGIC_SHORT1 = ObjectUtils.CONST((short) 123);</span>
<span class="fc" id="L583">        final short MAGIC_SHORT2 = ObjectUtils.CONST_SHORT(127);</span>
<span class="fc" id="L584">        final int MAGIC_INT = ObjectUtils.CONST(123);</span>
<span class="fc" id="L585">        final long MAGIC_LONG1 = ObjectUtils.CONST(123L);</span>
<span class="fc" id="L586">        final long MAGIC_LONG2 = ObjectUtils.CONST(3);</span>
<span class="fc" id="L587">        final float MAGIC_FLOAT = ObjectUtils.CONST(1.0f);</span>
<span class="fc" id="L588">        final double MAGIC_DOUBLE = ObjectUtils.CONST(1.0);</span>
<span class="fc" id="L589">        final String MAGIC_STRING = ObjectUtils.CONST(&quot;abc&quot;);</span>

<span class="fc" id="L591">        assertTrue(MAGIC_FLAG);</span>
<span class="fc" id="L592">        assertEquals(127, MAGIC_BYTE1);</span>
<span class="fc" id="L593">        assertEquals(127, MAGIC_BYTE2);</span>
<span class="fc" id="L594">        assertEquals('a', MAGIC_CHAR);</span>
<span class="fc" id="L595">        assertEquals(123, MAGIC_SHORT1);</span>
<span class="fc" id="L596">        assertEquals(127, MAGIC_SHORT2);</span>
<span class="fc" id="L597">        assertEquals(123, MAGIC_INT);</span>
<span class="fc" id="L598">        assertEquals(123, MAGIC_LONG1);</span>
<span class="fc" id="L599">        assertEquals(3, MAGIC_LONG2);</span>
<span class="fc" id="L600">        assertEquals(1.0f, MAGIC_FLOAT);</span>
<span class="fc" id="L601">        assertEquals(1.0, MAGIC_DOUBLE);</span>
<span class="fc" id="L602">        assertEquals(&quot;abc&quot;, MAGIC_STRING);</span>
<span class="fc" id="L603">        assertThrows(</span>
                IllegalArgumentException.class,
<span class="nc" id="L605">                () -&gt; ObjectUtils.CONST_BYTE(-129),</span>
                &quot;CONST_BYTE(-129): IllegalArgumentException should have been thrown.&quot;);
<span class="fc" id="L607">        assertThrows(</span>
                IllegalArgumentException.class,
<span class="nc" id="L609">                () -&gt; ObjectUtils.CONST_BYTE(128),</span>
                &quot;CONST_BYTE(128): IllegalArgumentException should have been thrown.&quot;);
<span class="fc" id="L611">        assertThrows(</span>
                IllegalArgumentException.class,
<span class="nc" id="L613">                () -&gt; ObjectUtils.CONST_SHORT(-32769),</span>
                &quot;CONST_SHORT(-32769): IllegalArgumentException should have been thrown.&quot;);
<span class="fc" id="L615">        assertThrows(</span>
                IllegalArgumentException.class,
<span class="nc" id="L617">                () -&gt; ObjectUtils.CONST_BYTE(32768),</span>
                &quot;CONST_SHORT(32768): IllegalArgumentException should have been thrown.&quot;);
<span class="fc" id="L619">    }</span>

    /**
     * String that is cloneable.
     */
    static final class CloneableString extends MutableObject&lt;String&gt; implements Cloneable {
        private static final long serialVersionUID = 1L;
        CloneableString(final String s) {
<span class="fc" id="L627">            super(s);</span>
<span class="fc" id="L628">        }</span>

        @Override
        public CloneableString clone() throws CloneNotSupportedException {
<span class="fc" id="L632">            return (CloneableString) super.clone();</span>
        }
    }

    /**
     * String that is not cloneable.
     */
    static final class UncloneableString extends MutableObject&lt;String&gt; implements Cloneable {
        private static final long serialVersionUID = 1L;
        UncloneableString(final String s) {
<span class="fc" id="L642">            super(s);</span>
<span class="fc" id="L643">        }</span>
    }

    static final class NonComparableCharSequence implements CharSequence {
        final String value;

        /**
         * Create a new NonComparableCharSequence instance.
         *
         * @param value
         */
        NonComparableCharSequence(final String value) {
<span class="fc" id="L655">            super();</span>
<span class="fc" id="L656">            Validate.notNull(value);</span>
<span class="fc" id="L657">            this.value = value;</span>
<span class="fc" id="L658">        }</span>

        @Override
        public char charAt(final int arg0) {
<span class="nc" id="L662">            return value.charAt(arg0);</span>
        }

        @Override
        public int length() {
<span class="nc" id="L667">            return value.length();</span>
        }

        @Override
        public CharSequence subSequence(final int arg0, final int arg1) {
<span class="nc" id="L672">            return value.subSequence(arg0, arg1);</span>
        }

        @Override
        public String toString() {
<span class="fc" id="L677">            return value;</span>
        }
    }

<span class="fc" id="L681">    static final class CharSequenceComparator implements Comparator&lt;CharSequence&gt; {</span>

        @Override
        public int compare(final CharSequence o1, final CharSequence o2) {
<span class="fc" id="L685">            return o1.toString().compareTo(o2.toString());</span>
        }

    }

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.2.201808211720</span></div></body></html>